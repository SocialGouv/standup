include:
  - project: SocialGouv/gitlab-ci-yml
    file: /autodevops.yml
    ref: v22.1.8

variables:
  AUTO_DEVOPS_ENABLE_KAPP: "üïπÔ∏è"
  AUTO_DEVOPS_TEST_DISABLED: "üõë"
  AUTO_DEVOPS_QUALITY_DISABLED: "üõë"

# Disabled jobs
Install:
  rules:
    - when: never
Build:
  rules:
    - when: never
Register image:
  rules:
    - when: never
Trigger Release:
  rules:
    - when: never

# On $DEPLOY jobs
Review:
  extends: .autodevops_review
  rules:
    - if: "$PRODUCTION || $RELEASE || $CI_COMMIT_TAG"
      when: never
    - if: "$DEPLOY"
      when: always
    - when: never

Notify Starting Deployment:
  extends: .autodevops_notify_starting_deployment
  rules:
    - if: "$RELEASE"
      when: never
    - if: "$AUTO_DEVOPS_NOTIFY_DISABLED"
      when: never
    - if: "$DEPLOY"
      when: always
    - when: never

Notify Fail:
  extends: .autodevops_notify_fail
  rules:
    - if: "$RELEASE"
      when: never
    - if: "$AUTO_DEVOPS_NOTIFY_DISABLED"
      when: never
    - if: "$DEPLOY"
      when: on_failure
    - when: never

Notify Success:
  extends: .autodevops_notify_success
  rules:
    - if: "$RELEASE"
      when: never
    - if: "$AUTO_DEVOPS_NOTIFY_DISABLED"
      when: never
    - if: "$DEPLOY"
      when: on_success
    - when: never

Stop review:
  rules:
    - if: "$PRODUCTION || $RELEASE || $CI_COMMIT_TAG"
      when: never
    - if: "$DEPLOY"
      when: manual
    - when: never
